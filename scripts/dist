#!/bin/bash
set -euo pipefail
IFS=$'/n/t'
trap 'echo FATAL ERROR EXIT CODE $? AT $0:$LINENO' ERR

# ./scripts/dist
# WITH_CUDA=true ./scripts/dist

if test $WITH_CUDA == "true" ; then
    WITH_CUDA=".WITH_CUDA"
else
    WITH_CUDA=""
fi

mkdir -p dist

#./InfiniTAM/build/Apps/InfiniTAM_cli/InfiniTAM_cli Teddy/calib.txt Teddy/Frames/%04i.ppm Teddy/Frames/%04i.pgm
./InfiniTAM/build/Apps/InfiniTAM/InfiniTAM Teddy/calib.txt Teddy/Frames/%04i.ppm Teddy/Frames/%04i.pgm

cp ./InfiniTAM/build/Apps/InfiniTAM_cli/Release/InfiniTAM_cli "./dist/InfiniTAM_cli$WITH_CUDA.exe"
cp ./InfiniTAM/build/Apps/InfiniTAM/Release/InfiniTAM "./dist/InfiniTAM$WITH_CUDA.exe"
cp ./data/download-teddy ./dist
cp ./scripts/InfiniTAM*.sh ./dist
